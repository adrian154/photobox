<!-- Quick proof of concept of photogrid -->
<!DOCTYPE html>
<html>
    <head>
        <style>
            body {
                background-color: #000;
            }

            #photogrid {
                max-width: 60em;
                margin: auto;
                display: flex;
                flex-direction: column;
            }
            
            .row {
                display: flex;
                flex-direction: row;
            }

            .row img {
                min-width: 0;
                margin: 3px;
            }
        </style>
        <meta name="viewport" content="width=device-width, initial-scale=1">
    </head>
    <body>
        <div id="photogrid"></div>
        <script>
            const collection = new URL(window.location).searchParams.get("collection");
            const photogrid = document.getElementById("photogrid");

            const newRow = () => {
                const row = document.createElement("div");
                row.classList.add("row");
                photogrid.append(row);
                return row;
            };

            fetch(`/api/collections/${collection}`).then(resp => resp.json()).then(collection => {
                let row = newRow();
                for(const post of collection.posts) {
                    
                    const img = document.createElement("img");
                    img.loading = "lazy";
                    img.width = post.thumbnail.width;
                    img.height = post.thumbnail.height;
                    img.src = post.thumbnail.url;
                    row.append(img);

                    if(img.width < post.thumbnail.width) {
                        const height = Math.round(post.thumbnail.height * img.width / post.thumbnail.width) + "px";
                        row.querySelectorAll("img").forEach(img => {
                            img.style.height = height;
                        });
                        row = newRow();
                    }

                }
                const div = document.createElement("div");
                div.style.flexGrow = "100";
                photogrid.append(div);
            });

        </script>
    </body>
</html>